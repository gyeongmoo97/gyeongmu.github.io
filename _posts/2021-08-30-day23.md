

---
title: Day
layout: single
author_profile: true
read_time: true
comments: true
share: true
related: true
categories:
- DB
description: .

meta_keywords: java,static,memory
last_modified_at: '2021-08-10 12:00:00 +0800'
toc: true
toc_sticky: false
toc_label: 목차
---
 {% raw %}



# Controller를 거치지 않는 요청

컨트롤러의 역할 : 클라이언트가 요청을 보내면 요청을 처리하는 역할을 한다.

![image](https://user-images.githubusercontent.com/65274952/131269883-d93aa154-7d70-4775-a98c-3953f36790bd.png)

중간 경로로 컨트롤러를 선택하고 

세부 경로를 이용해서 컨트롤러 메서드를 선택하는 형태로 요청을 처리함.



하지만 **모든 요청**이 **컨트롤러**를 통해 처리되어야 하나?

모든 파일이 컨트롤러를통해서 요청되는것은 아니다.



정적인내용, 모든 사용자에게 같은 것을 보여주는 것과 같은 내용 -> 

굳이 컨트롤러가처리할 필요가 없다. 컨트롤러는 java에서 코드를 실행하여 실행할 필요가 있는 내용만 처리하면 된다.

컨트롤러가 모든 요청에 관여하면 컨트롤러가 과부하된다.





resources 라고 적혀있으면 그 폴더는 컨트롤러가 관여하지 않음

컨트롤러 거치지 않고바로 경로에 있는 내용,파일을 호출해줄 수 있음.

```html
<img src="${pageContext.request.contextPath}/resources/images/logo-spring.png" }/>
```

이런식으로 



![image](https://user-images.githubusercontent.com/65274952/131270191-6f335287-670b-469e-be31-27196471250f.png)

spring 설정을 관리하는 servlet-context 라는 xml 파일이 있다.



```xml
<resources mapping="/resources/**" location="/resources/" />

/**
의미는 이 뒤의 경로는 상관없이

```

/ (컨텍스트 루트 뒤에 ) resources가 나오면 뭐가나오든 resources 위치로 연결하라는 의미



```xml
<resources mapping="/frontend/**" location="frontend"/>
```

컨트롤러가 관여하지 않는 경로 여러개 설정하는것도 가능





# 라이브러리 내장



```html
 <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
```

지금 이 라이브러리는 cdn 에서 받아온다.

그런데 cdn 서버 문제가 생기면?

ui가 깨진다.

resources에 미리 다운받아놓는다면 문제가 생기지 않는다.

<img src="https://user-images.githubusercontent.com/65274952/131270541-d5dc8ffe-b836-4ea3-805a-3fffd5397be3.png" alt="image" style="zoom:50%;" />





> include 되는 파일은 절대경로를 사용하는게 좋다. ( 상대경로면어디에 include 되는지에 따라 영향을 받을 수 있기 때문 ) 



![image](https://user-images.githubusercontent.com/65274952/131272382-34a6642b-6d1a-470b-878d-7d9f7d4630cc.png)

https://code.jquery.com/

https://code.jquery.com/jquery/

가서 다운받고 resources에 넣어줬다.





# resources 폴더 관리 주의점

컨트롤러를 거치지 않기 때문에 누구라도 접근가능하다.

특정사용자, 특정과정을 거쳐야 볼 수 있는 내용은 resources에 두면 안된다.

모든 img를 resources에 넣으면 안된다.



# Deploy

배치한다는 의미이다.

최종 산출물에 포함이 되어서 운영서버에 배치될 내용이 담겨있다.

![image](https://user-images.githubusercontent.com/65274952/131271337-83703c9e-0986-4755-9c77-7108ca46c405.png)

Deployed Resources 아래의 

webapp폴더 등의 내용이 최종 산출물 war에 포함되고 운영서버에 배치된다.

## root context 경로로 접근하게 되는 디렉토리

```
http://localhost:8080/contextRoot/ 
에서 /는
webapp/ 과 같다고 생각해도 된다.

```

**

즉 현재 우리는 / 를 root context로 설정하였기 때문에
8080/ 까지 입력하면  webapp 아래의 폴더가 열린다.

webapp 폴더에 포함된 항목인 index.jsp는 

8080/index.jsp 주소로 호출이 가능하다.



![image](https://user-images.githubusercontent.com/65274952/131271566-ff1ffb4a-ceff-41e6-b939-fec710f93125.png)

최종 산출물을 위의 방식으로 install 하면

war 파일이 생성되는데 war을 압축해제 해보면

deploy 파일이 최종산출물에 그대로 들어가게 된다.

![image](https://user-images.githubusercontent.com/65274952/131271756-1a1de621-638a-48d9-a246-895ea794c349.png)



# Spring Project 의 폴더 구조

![image](https://user-images.githubusercontent.com/65274952/131273335-a8f2ff77-2861-48d1-a444-f9ad1df06aa3.png)


![image](https://user-images.githubusercontent.com/65274952/131273279-fd9ba306-83b6-4be0-83b2-9dd4ab488687.png)
바바이트 코드가 컴파일 되어서 들어가있음 (war에 포함되어 있음)

web-inf의 lib 안에는 jar 파일이 많이 있음

![image](https://user-images.githubusercontent.com/65274952/131273398-bc77c3fa-36d5-4cf4-aec2-1de5aff2e477.png)
최종산출물을 만들 때는 web-inf 의 lib 폴더에 저장이됨.

최종산출물 만들기 전에는 참조만 함

# vJava Web Application 구조와 Spring MVC Project 구조 비교



![image](https://user-images.githubusercontent.com/65274952/131274496-03e980b8-9a2f-41c5-b129-575002d99cf5.png)



![image](https://user-images.githubusercontent.com/65274952/131274238-614a83b7-c6b3-43d5-837e-080e3463ab39.png)
![image](https://user-images.githubusercontent.com/65274952/131274249-2b9de27d-c442-4df2-8333-6b6a21b9e319.png)
뒤의 2개는 같은것이다.

![image](https://user-images.githubusercontent.com/65274952/131274324-b7531552-a8a2-429d-872e-ffbf5c3e4aa8.png)
자바 소스에 접근할때는 위의 경로에서 작업하는게 좋다. 위의 경로에서 작업하면 아래의 src 에 자동 취합된다.
![image](https://user-images.githubusercontent.com/65274952/131274313-3a21687e-4d4d-4488-96c0-0baaa983ae55.png)
아래는 파일 시스템에서의 class 들을 보여주는 역할임  여기서 직접 작업하는것은 좋지 않다.





src/main 에 있는 내용은 모두 classes 에 들어간다.

![image](https://user-images.githubusercontent.com/65274952/131274449-d26a231d-d0e3-447c-9024-dee29f3dd02f.png)

test는 최종산출물에 안들어간다.



# maven dependencies

메이븐 내용을 조정하려면 

pom.xml 의 의존성을 설정해주면된다. 그러면 jar파일이 알아서 들어간다.





![image](https://user-images.githubusercontent.com/65274952/131274545-b8479a75-1ddc-481c-a6ae-b70e8220227b.png)



# web.xml

제일 먼저 해석되는 문서가 web.xml 이고 이것을 제대로 해석하기 위해서 servlet jsp를 공부하는 것임



```xml
<servlet>
		<servlet-name>appServlet</servlet-name>
		<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
		<init-param>
			<param-name>contextConfigLocation</param-name>
			<param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
		</init-param>
		<load-on-startup>1</load-on-startup>
	</servlet>
```

DispatcherServlet이라는 클래스를 통해서

```
<param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
```

이부분을 web.xml 이 알려준다.



스프링 설정파일이 기술된 위치는 web.xml의 servlet 태그 안에서 정의되어있다.

<img src="https://user-images.githubusercontent.com/65274952/131274792-e0591732-6a04-4510-b2ce-7103dbc9a404.png" alt="image" style="zoom:50%;" />

여기를 통해서 스프링의설정을 구성한다



만약

![image](https://user-images.githubusercontent.com/65274952/131275934-17688800-7404-4dbf-a197-8dea125cf5cd.png)

없는 context2.xml을 통해서 스프링 설정을 구성하겠다고 정의하면?

-> 에러 발생



![image](https://user-images.githubusercontent.com/65274952/131276079-ce2d6012-54de-46ab-879a-6c4d83582dd3.png)

설정파일 경로 뒤에 특정 설정파일의 이름이 아닌 /*.xml 으로 작성하면

특정 경로뒤 모든 xml 파일을 사요할수 있게된다. 

여러개의 스프링 설정 파일을 사용할 수 있다.



![image](https://user-images.githubusercontent.com/65274952/131276127-e98498fb-1075-4c7a-b76b-a4c1bd6228a0.png)

설정파일의 이름을 바꿔도 정상작동한다.

# URL로 접근하는 경우



![image](https://user-images.githubusercontent.com/65274952/131276314-8cc50a18-ce5e-45b7-b0c9-c175b4c1cfe2.png)



/photo1.jpg 하면 접근 가능해야하는게 맞다.

하지만 

![image](https://user-images.githubusercontent.com/65274952/131276594-521e5fd0-6d41-4c9a-b7a5-1a60c6ac163e.png)

![image](https://user-images.githubusercontent.com/65274952/131277030-3524178f-a1f4-4f63-82ec-4eead879dfb7.png)

컨트롤러 없이 접근할 수 있는 

# 자투리



8080포트를 사용중이라서 서버를 사용 불가능하다는 에러가 호출되었을 때 tomcat 서버를 중지시켜야한다.

![image](https://user-images.githubusercontent.com/65274952/131271090-4c7ea27d-9bbb-4243-b721-b75c2f0ec452.png)



우클릭하여 프로그램 끝내기 해주면 된다.



> include 되는 파일은 절대경로를 사용하는게 좋다. ( 상대경로면어디에 include 되는지에 따라 영향을 받을 수 있어서 ) 



![image](https://user-images.githubusercontent.com/65274952/131273655-df3ac2cd-abf8-4463-90c6-bc9a0a782737.png)

4.0 안뜨면

프로젝트 우클릭 메이븐 업데이트





오류 뜨는것 

![image](https://user-images.githubusercontent.com/65274952/131274986-c340bb5a-5717-41d2-8adc-13921d4e752a.png)



![image](https://user-images.githubusercontent.com/65274952/131275040-d3d14972-b840-4332-bd9b-2c93fad3e68e.png)



 {% endraw %}